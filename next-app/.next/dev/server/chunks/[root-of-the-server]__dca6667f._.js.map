{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/carbonsense/next-app/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst prismaClientSingleton = () => {\n  return new PrismaClient();\n};\n\ntype PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>;\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClientSingleton | undefined;\n};\n\nconst prisma = globalForPrisma.prisma ?? prismaClientSingleton();\n\nexport default prisma;\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC5B,OAAO,IAAI,sMAAY;AACzB;AAIA,MAAM,kBAAkB;AAIxB,MAAM,SAAS,gBAAgB,MAAM,IAAI;uCAE1B;AAEf,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/carbonsense/next-app/lib/cloudinary.ts"],"sourcesContent":["// myModule.js\nimport { v2 as cloudinary } from \"cloudinary\";\n\ncloudinary.config({\n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n  api_key: process.env.CLOUDINARY_API_KEY,\n  api_secret: process.env.CLOUDINARY_API_SECRET,\n});\n\nexport default cloudinary;\n"],"names":[],"mappings":";;;;AAAA,cAAc;AACd;;AAEA,gJAAU,CAAC,MAAM,CAAC;IAChB,YAAY,QAAQ,GAAG,CAAC,qBAAqB;IAC7C,SAAS,QAAQ,GAAG,CAAC,kBAAkB;IACvC,YAAY,QAAQ,GAAG,CAAC,qBAAqB;AAC/C;uCAEe,gJAAU"}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/carbonsense/next-app/lib/uploadoncloudinary.ts"],"sourcesContent":["import cloudinary from \"./cloudinary\";\nimport streamifier from \"streamifier\";\nimport { UploadApiResponse } from \"cloudinary\";\n\nexport const uploadStreamToCloudinary = (\n  fileBuffer: Buffer,\n): Promise<UploadApiResponse> => {\n  return new Promise((resolve, reject) => {\n    let stream = cloudinary.uploader.upload_stream(\n      { resource_type: \"auto\" },\n      (error, result) => {\n        if (result) {\n          resolve(result);\n        } else {\n          reject(error);\n        }\n      },\n    );\n    streamifier.createReadStream(fileBuffer).pipe(stream);\n  });\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,MAAM,2BAA2B,CACtC;IAEA,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,IAAI,SAAS,8HAAU,CAAC,QAAQ,CAAC,aAAa,CAC5C;YAAE,eAAe;QAAO,GACxB,CAAC,OAAO;YACN,IAAI,QAAQ;gBACV,QAAQ;YACV,OAAO;gBACL,OAAO;YACT;QACF;QAEF,wJAAW,CAAC,gBAAgB,CAAC,YAAY,IAAI,CAAC;IAChD;AACF"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/carbonsense/next-app/app/api/user/sign-up/route.ts"],"sourcesContent":["import prisma from \"@/lib/prisma\";\nimport { NextRequest, NextResponse } from \"next/server\";\nimport bcrypt from \"bcrypt\";\nimport { uploadStreamToCloudinary } from \"@/lib/uploadoncloudinary\";\n\nexport async function POST(req: NextRequest, res: NextResponse) {\n  try {\n    const body = await req.formData();\n    const name = body.get(\"name\") as string;\n    const email = body.get(\"email\") as string;\n    const password = body.get(\"password\") as string;\n    const avatar = body.get(\"avatar\");\n\n    if (!name || !email || !password || !avatar) {\n      return NextResponse.json(\n        { message: \"all the field is required\" },\n        { status: 401 },\n      );\n    }\n\n    const isExits = await prisma.user.findUnique({\n      where: {\n        name: name,\n      },\n    });\n\n    // checking that user is not there\n    if (isExits) {\n      return NextResponse.json(\n        { message: \"user already exits\" },\n        { status: 409 },\n      );\n    }\n\n    // uploading on cloudinary\n    const imageBuffer = Buffer.from(await (avatar as Blob).arrayBuffer());\n    const storedImageOnCloudinary = await uploadStreamToCloudinary(imageBuffer);\n\n    if (!storedImageOnCloudinary) {\n      return NextResponse.json(\n        { message: \"something went wrong on uploading the media\" },\n        { status: 409 },\n      );\n    }\n\n    const avatarFromCloudinary = storedImageOnCloudinary?.secure_url as string;\n\n    // hashing the password\n    const salt = bcrypt.genSaltSync(10);\n    const hashPassword = bcrypt.hashSync(password, salt);\n\n    // creating the new user\n    const user = await prisma.user.create({\n      data: {\n        name: name,\n        email: email,\n        password: hashPassword,\n        avatar: avatarFromCloudinary,\n        avatarPublicId: storedImageOnCloudinary?.public_id,\n      },\n      select: {\n        id: true,\n        name: true,\n        email: true,\n      },\n    });\n\n    return NextResponse.json(\n      { message: \"user sign-up done\", user: user },\n      { status: 200 },\n    );\n  } catch (error) {\n    console.log(\"the error while doing the sign-up : \", error);\n    return NextResponse.json(\n      { message: \"something went wrong at time of sign-up\" },\n      { status: 500 },\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAgB,EAAE,GAAiB;IAC5D,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,QAAQ;QAC/B,MAAM,OAAO,KAAK,GAAG,CAAC;QACtB,MAAM,QAAQ,KAAK,GAAG,CAAC;QACvB,MAAM,WAAW,KAAK,GAAG,CAAC;QAC1B,MAAM,SAAS,KAAK,GAAG,CAAC;QAExB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAA4B,GACvC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,0HAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAC3C,OAAO;gBACL,MAAM;YACR;QACF;QAEA,kCAAkC;QAClC,IAAI,SAAS;YACX,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAAqB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,0BAA0B;QAC1B,MAAM,cAAc,OAAO,IAAI,CAAC,MAAM,AAAC,OAAgB,WAAW;QAClE,MAAM,0BAA0B,MAAM,IAAA,uJAAwB,EAAC;QAE/D,IAAI,CAAC,yBAAyB;YAC5B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAA8C,GACzD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,uBAAuB,yBAAyB;QAEtD,uBAAuB;QACvB,MAAM,OAAO,6JAAM,CAAC,WAAW,CAAC;QAChC,MAAM,eAAe,6JAAM,CAAC,QAAQ,CAAC,UAAU;QAE/C,wBAAwB;QACxB,MAAM,OAAO,MAAM,0HAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBACJ,MAAM;gBACN,OAAO;gBACP,UAAU;gBACV,QAAQ;gBACR,gBAAgB,yBAAyB;YAC3C;YACA,QAAQ;gBACN,IAAI;gBACJ,MAAM;gBACN,OAAO;YACT;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAqB,MAAM;QAAK,GAC3C;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,wCAAwC;QACpD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAA0C,GACrD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}